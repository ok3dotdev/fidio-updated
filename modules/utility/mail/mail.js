import{fetchPost}from"../fetch/fetch";import{logout}from"/modules/utility/onboarding/SignIn.js";import newUser from"/layout/mail/newUser";import mails from"/layout/mail";import apiReq from"/modules/utility/api/apiReq";const sendSurveyEmail=async(e,t,i,a,s)=>{t={domainKey:t,hash:s?.hash,identifier:s?.identifier,answers:i,surveyName:a},s=await fetchPost(e+"/m/sendsurveyemail",null,null,t);if(s&&s.hasOwnProperty("status")){if("disauthenticated"==s.status)return logout(),"disauthenticated";if("failed"==s.status)return!1;if("success"==s.status)return s}return!1},handleEventMail=async(e,t)=>{var i,a=e?.event??e?.action??null;if(a){if("newUser"===a){const k=newUser(t);await apiReq("/email/sendEmail",{toUserId:e?.data?.identifier,content:k.content,subject:k.subject})}try{console.log("Attempt Send",a,mails,e,k),mails&&mails[a]&&(i=mails[a](t),await apiReq("/email/sendEmail",{toUserId:i?.toUserId??e?.data?.identifier,tousername:i?.toUsername??null,content:i.content,subject:i.subject}))}catch(e){console.log(e)}}};export{sendSurveyEmail,handleEventMail};