import{fetchPost}from"/modules/utility/fetch/fetch.js";import{logout}from"/modules/utility/onboarding/SignIn.js";const beginStream=async(t,e,s,i)=>{i=i();if(i&&i.identifier&&i.hash){s={cus_id:s.stripeSecret.user,dontForce:s.dontForce,streamSettings:s.streamSettings,domainKey:e,hash:i.hash,identifier:i.identifier},e=await fetchPost(t+"/m/beginstream",null,null,s);if(e&&e.hasOwnProperty("status")){if("disauthenticated"==e.status)return logout(),"disauthenticated";if("failed"==e.status)return!1;if("success"==e.status)return e}}return!1},endStream=async(t,e,s,i)=>{i=i();if(i&&i.identifier&&i.hash){s={stream:s.stream,domainKey:e,hash:i.hash,identifier:i.identifier},e=await fetchPost(t+"/m/endstream",null,null,s);if(e&&e.hasOwnProperty("status")){if("disauthenticated"==e.status)return logout(),"disauthenticated";if("failed"==e.status)return!1;if("success"==e.status)return e}}return!1},doFetchAuthForStream=async(t,e,s,i)=>{i=i();if(i&&i.identifier&&i.hash){s={stream:s,domainKey:e,hash:i.hash,identifier:i.identifier},e=await fetchPost(t+"/m/getauthforstream",null,null,s);if(e&&e.hasOwnProperty("status")){if("disauthenticated"==e.status)return logout(),"disauthenticated";if("failed"==e.status)return!1;if("success"==e.status)return e}}return!1},updateStreamConfigRequest=async(t,e,s,i)=>{i=i();if(i&&i.identifier&&i.hash){s={stream:s.stream,streamData:s.streamData,streamSettings:s.streamSettings,domainKey:e,hash:i.hash,identifier:i.identifier},e=(console.log(s),await fetchPost(t+"/m/updatestreamconfig",null,null,s));if(e&&e.hasOwnProperty("status")){if("disauthenticated"==e.status)return logout(),"disauthenticated";if("failed"==e.status)return!1;if("success"==e.status)return e}}return!1},requestStreamingPermissions=async(t,e,s)=>{s=s();if(s&&s.identifier&&s.hash){e={domainKey:e,hash:s.hash,identifier:s.identifier},s=(console.log(e),await fetchPost(t+"/m/requeststreamingpermissions",null,null,e));if(s&&s.hasOwnProperty("status")){if("disauthenticated"==s.status)return logout(),"disauthenticated";if("failed"==s.status)return!1;if("success"==s.status)return s}}return!1};export{beginStream,endStream,doFetchAuthForStream,updateStreamConfigRequest,requestStreamingPermissions};